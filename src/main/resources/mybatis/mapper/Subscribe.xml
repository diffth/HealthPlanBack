<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.healthplan.work.dao.SubscribeMapper">

	<!-- 구독 목록 -->
	<select id="selectSubscribeList" resultType="com.healthplan.work.vo.SubscribeVO">

		SELECT
			  SNO
			, MNO
			, UUID
			, STYPE
			, TITLE
			, CONTENTS
			, TO_CHAR(WDATE, 'YYYY-MM-DD') AS WDATE
			, COUNTS
			, FILEID
			, REPLYCNT
			, (SELECT FILENAME FROM SATTACHED WHERE IMGTYPE = 'M' AND SNO = S.SNO) AS TITLEIMG
			, SPOINT
		FROM  SUBSCRIBE S
		WHERE 1=1
		AND STYPE = 'T'



		ORDER BY SNO DESC

	</select>

	<!-- 구독 조회 -->
	<select id="selectSubscribeRead" resultType="com.healthplan.work.vo.SubscribeVO">

		SELECT
			  SNO
			, MNO
			, UUID
			, STYPE
			, TITLE
			, CONTENTS
			, WDATE
			, COUNTS
			, FILEID
			, REPLYCNT
			, SPOINT
		FROM  SUBSCRIBE
		WHERE SNO = #{sno}

	</select>


	<!-- 구독 등록 -->
	<insert id="insertSubscribe">

		INSERT INTO SUBSCRIBE(
			  SNO
			, MNO
			, UUID
			, STYPE
			, TITLE
			, CONTENTS
			, SPOINT
			, WDATE
		) VALUES (
			  SNO_SEQ.NEXTVAL
			, #{mno}
			, #{uuid}
			, 'T'
			, #{title}
			, #{contents}
			, #{spoint}
			, SYSDATE
		)

	</insert>

	<!-- 구독 등록 -->
	<update id="updateSubscribe">

		UPDATE SUBSCRIBE
		SET
			  TITLE		= #{title}
			, CONTENTS	= #{contents}
			, SPOINT	= #{spoint}
		WHERE SNO 		= #{sno}

	</update>

	<!-- 구독 삭제 -->
	<delete id="deleteSubscribe">

		DELETE FROM SUBSCRIBE WHERE SNO = #{sno}

	</delete>

</mapper>
